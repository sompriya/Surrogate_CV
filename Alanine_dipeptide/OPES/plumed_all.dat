# vim:ft=plumed

MOLINFO STRUCTURE=input.ala2.pdb
phi: TORSION ATOMS=@phi-2
psi: TORSION ATOMS=@psi-2
ene: ENERGY

d1:  DISTANCE ATOMS=2,5
d2:  DISTANCE ATOMS=2,6
d3:  DISTANCE ATOMS=2,7
d4:  DISTANCE ATOMS=2,9
d5:  DISTANCE ATOMS=2,11
d6:  DISTANCE ATOMS=2,15
d7:  DISTANCE ATOMS=2,16
d8:  DISTANCE ATOMS=2,17
d9:  DISTANCE ATOMS=2,19
d10:  DISTANCE ATOMS=5,6
d11:  DISTANCE ATOMS=5,7
d12:  DISTANCE ATOMS=5,9
d13:  DISTANCE ATOMS=5,11
d14:  DISTANCE ATOMS=5,15
d15:  DISTANCE ATOMS=5,16
d16:  DISTANCE ATOMS=5,17
d17:  DISTANCE ATOMS=5,19
d18:  DISTANCE ATOMS=6,7
d19:  DISTANCE ATOMS=6,9
d20:  DISTANCE ATOMS=6,11
d21:  DISTANCE ATOMS=6,15
d22:  DISTANCE ATOMS=6,16
d23:  DISTANCE ATOMS=6,17
d24:  DISTANCE ATOMS=6,19
d25:  DISTANCE ATOMS=7,9
d26:  DISTANCE ATOMS=7,11
d27:  DISTANCE ATOMS=7,15
d28:  DISTANCE ATOMS=7,16
d29:  DISTANCE ATOMS=7,17
d30:  DISTANCE ATOMS=7,19
d31:  DISTANCE ATOMS=9,11
d32:  DISTANCE ATOMS=9,15
d33:  DISTANCE ATOMS=9,16
d34:  DISTANCE ATOMS=9,17
d35:  DISTANCE ATOMS=9,19
d36:  DISTANCE ATOMS=11,15
d37:  DISTANCE ATOMS=11,16
d38:  DISTANCE ATOMS=11,17
d39:  DISTANCE ATOMS=11,19
d40:  DISTANCE ATOMS=15,16
d41:  DISTANCE ATOMS=15,17
d42:  DISTANCE ATOMS=15,19
d43:  DISTANCE ATOMS=16,17
d44:  DISTANCE ATOMS=16,19
d45:  DISTANCE ATOMS=17,19

t1: TORSION ATOMS=5,7,9,15
t2: TORSION ATOMS=7,9,15,17
t3: TORSION ATOMS=1,2,5,6
t4: TORSION ATOMS=1,2,5,7
t5: TORSION ATOMS=3,2,5,6
t6: TORSION ATOMS=3,2,5,7
t7: TORSION ATOMS=4,2,5,6
t8: TORSION ATOMS=4,2,5,7
t9: TORSION ATOMS=2,5,7,8
t10: TORSION ATOMS=2,5,7,9
t11: TORSION ATOMS=6,5,7,8
t12: TORSION ATOMS=2,5,7,9
t13: TORSION ATOMS=5,7,9,10
t14: TORSION ATOMS=5,7,9,11
t15: TORSION ATOMS=8,7,9,10
t16: TORSION ATOMS=8,7,9,11
t17: TORSION ATOMS=8,7,9,15
t18: TORSION ATOMS=7,9,11,12
t19: TORSION ATOMS=7,9,11,13
t20: TORSION ATOMS=7,9,11,14
t21: TORSION ATOMS=10,9,11,12
t22: TORSION ATOMS=10,9,11,13
t23: TORSION ATOMS=10,9,11,14
t24: TORSION ATOMS=15,9,11,12
t25: TORSION ATOMS=15,9,11,13
t26: TORSION ATOMS=15,9,11,14
t27: TORSION ATOMS=7,9,15,16
t28: TORSION ATOMS=10,9,15,16
t29: TORSION ATOMS=10,9,15,17
t30: TORSION ATOMS=11,9,15,16
t31: TORSION ATOMS=11,9,15,17
t32: TORSION ATOMS=9,15,17,18
t33: TORSION ATOMS=9,15,17,19
t34: TORSION ATOMS=16,15,17,18
t35: TORSION ATOMS=16,15,17,19
t36: TORSION ATOMS=15,17,19,20
t37: TORSION ATOMS=15,17,19,21
t38: TORSION ATOMS=15,17,19,22
t39: TORSION ATOMS=18,17,19,20
 
cost1: MATHEVAL ARG=t1 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost2: MATHEVAL ARG=t2 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost3: MATHEVAL ARG=t3 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost4: MATHEVAL ARG=t4 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost5: MATHEVAL ARG=t5 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost6: MATHEVAL ARG=t6 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost7: MATHEVAL ARG=t7 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost8: MATHEVAL ARG=t8 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost9: MATHEVAL ARG=t9 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost10: MATHEVAL ARG=t10 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost11: MATHEVAL ARG=t11 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost12: MATHEVAL ARG=t12 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost13: MATHEVAL ARG=t13 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost14: MATHEVAL ARG=t14 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost15: MATHEVAL ARG=t15 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost16: MATHEVAL ARG=t16 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost17: MATHEVAL ARG=t17 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost18: MATHEVAL ARG=t18 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost19: MATHEVAL ARG=t19 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost20: MATHEVAL ARG=t20 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost21: MATHEVAL ARG=t21 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost22: MATHEVAL ARG=t22 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost23: MATHEVAL ARG=t23 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost24: MATHEVAL ARG=t24 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost25: MATHEVAL ARG=t25 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost26: MATHEVAL ARG=t26 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost27: MATHEVAL ARG=t27 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost28: MATHEVAL ARG=t28 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost29: MATHEVAL ARG=t29 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost30: MATHEVAL ARG=t30 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost31: MATHEVAL ARG=t31 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost32: MATHEVAL ARG=t32 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost33: MATHEVAL ARG=t33 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost34: MATHEVAL ARG=t34 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost35: MATHEVAL ARG=t35 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost36: MATHEVAL ARG=t36 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost37: MATHEVAL ARG=t37 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost38: MATHEVAL ARG=t38 FUNC=0.5+cos(x-1.25) PERIODIC=NO
cost39: MATHEVAL ARG=t39 FUNC=0.5+cos(x-1.25) PERIODIC=NO

# Deep-TDA CV (distances as descriptor)
deepTDA: PYTORCH_MODEL FILE=ala2_deepTDA.pt ARG=d1,d2,d3,d4,d5,d6,d7,d8,d9,d10,d11,d12,d13,d14,d15,d16,d17,d18,d19,d20,d21,d22,d23,d24,d25,d26,d27,d28,d29,d30,d31,d32,d33,d34,d35,d36,d37,d38,d39,d40,d41,d42,d43,d44,d45

#Surrogate Model of Deep-TDA CV (distances as descriptor)
lassoTDA: COMBINE ARG=d9,d19,d20,d21,d22,d23,d24,d25,d26,d28,d30,d33,d37,d38,d39, COEFFICIENTS=4.2236,123.9035,-74.1519,-24.5484,-20.8633,-3.6156,-10.3116,-15.1608,36.7252,22.8718,8.6337,-1.8104,5.3758,-1.7865,-0.6806, PERIODIC=NO
 
lassoCV_TDA: MATHEVAL ARG=lassoTDA FUNC=x-6.1677 PERIODIC=NO


#Deep-TICA CV (distances as descriptor)
deepTICA: PYTORCH_MODEL FILE=ala2_deepTICA.ptc ARG=d1,d2,d3,d4,d5,d6,d7,d8,d9,d10,d11,d12,d13,d14,d15,d16,d17,d18,d19,d20,d21,d22,d23,d24,d25,d26,d27,d28,d29,d30,d31,d32,d33,d34,d35,d36,d37,d38,d39,d40,d41,d42,d43,d44,d45

#Surrogate Model of Deep-TICA CV (distances as descriptor)
lassoTICA: COMBINE ARG=d3,d5,d9,d11,d13,d16,d17,d19,d20,d21,d22,d23,d26,d27,d28,d30,d33,d34,d37,d38,d43,d44, COEFFICIENTS=-2.1943,0.5962,0.2754,-0.4293,-0.7594,-0.1269,-1.7356,13.3339,-8.7770,-0.1922,-2.5192,-2.5143,3.1540,1.5354,1.8088,2.4623,-1.7945,0.2039,1.0735,-0.0421,-1.9173,-0.0261, PERIODIC=NO
 
lassoCV_TICA: MATHEVAL ARG=lassoTICA FUNC=x+0.1539 PERIODIC=NO

# Deep-TDA CV (torsion angles as descriptor)
deepTDA_torsion: PYTORCH_MODEL FILE=ala2_torsion_deepTDA.pt ARG=cost1,cost2,cost3,cost4,cost5,cost6,cost7,cost8,cost9,cost10,cost11,cost12,cost13,cost14,cost15,cost16,cost17,cost18,cost19,cost20,cost21,cost22,cost23,cost24,cost25,cost26,cost27,cost28,cost29,cost30,cost31,cost32,cost33,cost34,cost35,cost36,cost37,cost38,cost39

#Surrogate Model of Deep-TDA CV ( torsion angles as descriptor)
lassoTDA_torsion: COMBINE ARG=cost1,cost4,cost10,cost11,cost12,cost14,cost15,cost16,cost17,cost18,cost20,cost27,cost30,cost31,cost34,cost37,cost38, COEFFICIENTS=4.1663,0.0186,-0.0581,-0.1556,-0.0001,-0.2719,0.5317,0.6360,-0.3828,0.0069,-0.0240,0.0418,-0.1093,0.0003,0.0484,-0.0143,0.0014, PERIODIC=NO
 
lassoCV_TDA_torsion: MATHEVAL ARG=lassoTDA_torsion FUNC=x-2.6641 PERIODIC=NO





OPES_METAD ...
  LABEL=opes
  ARG=deepTDA.node-0
  #ARG=lassoCV_TDA
  #ARG=deepTICA.node-0
  #ARG=lassoCV_TICA
  #ARG=deepTDA_torsion.node-0
  #ARG=lassoCV_TDA_torsion
  PACE=500
  BARRIER=40
  TEMP=300
...


PRINT FMT=%g STRIDE=500 FILE=COLVAR ARG=deepTDA.node-0,lassoCV_TDA,deepTICA.node-0,lassoCV_TICA,deepTDA_torsion.node-0,lassoCV_TDA_torsion,opes.bias

ENDPLUMED



